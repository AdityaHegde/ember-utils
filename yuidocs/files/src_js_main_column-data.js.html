<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/js/main/column-data.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Alerts.AlertMessageComponent.html">Alerts.AlertMessageComponent</a></li>
            
                <li><a href="../classes/AppWrapper.AppWrapper.html">AppWrapper.AppWrapper</a></li>
            
                <li><a href="../classes/DragDrop.DraggableMixin.html">DragDrop.DraggableMixin</a></li>
            
                <li><a href="../classes/DragDrop.DroppableMixin.html">DragDrop.DroppableMixin</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextCollapsibleColumnDataMixin.html">GlobalModules.DisplayTextCollapsibleColumnDataMixin</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextCollapsibleGlypiconColumnDataMixin.html">GlobalModules.DisplayTextCollapsibleGlypiconColumnDataMixin</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextCollapsibleGlypiconView.html">GlobalModules.DisplayTextCollapsibleGlypiconView</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextCollapsibleView.html">GlobalModules.DisplayTextCollapsibleView</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextColumnDataMixin.html">GlobalModules.DisplayTextColumnDataMixin</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextView.html">GlobalModules.DisplayTextView</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextWithTooltipColumnDataMixin.html">GlobalModules.DisplayTextWithTooltipColumnDataMixin</a></li>
            
                <li><a href="../classes/GlobalModules.DisplayTextWithTooltipView.html">GlobalModules.DisplayTextWithTooltipView</a></li>
            
                <li><a href="../classes/GlobalModules.GlobalModuleColumnDataGroupMixin.html">GlobalModules.GlobalModuleColumnDataGroupMixin</a></li>
            
                <li><a href="../classes/LazyDisplay.LazyDisplayColumnDataGroup.html">LazyDisplay.LazyDisplayColumnDataGroup</a></li>
            
                <li><a href="../classes/LazyDisplay.LazyDisplayView.html">LazyDisplay.LazyDisplayView</a></li>
            
                <li><a href="../classes/ListGroup.ListColumnData.html">ListGroup.ListColumnData</a></li>
            
                <li><a href="../classes/ListGroup.ListColumnDataGroup.html">ListGroup.ListColumnDataGroup</a></li>
            
                <li><a href="../classes/ListGroup.ListGroupView.html">ListGroup.ListGroupView</a></li>
            
                <li><a href="../classes/ListGroup.ListItemView.html">ListGroup.ListItemView</a></li>
            
                <li><a href="../classes/ModelWrapper.ModelWrapper.html">ModelWrapper.ModelWrapper</a></li>
            
                <li><a href="../classes/Panels.PanelCollapsibleView.html">Panels.PanelCollapsibleView</a></li>
            
                <li><a href="../classes/Panels.PanelColumnDataGroup.html">Panels.PanelColumnDataGroup</a></li>
            
                <li><a href="../classes/Panels.PanelsView.html">Panels.PanelsView</a></li>
            
                <li><a href="../classes/Panels.PanelView.html">Panels.PanelView</a></li>
            
                <li><a href="../classes/Timer.AsyncQue.html">Timer.AsyncQue</a></li>
            
                <li><a href="../classes/Timer.Timer.html">Timer.Timer</a></li>
            
                <li><a href="../classes/Tree.LeafView.html">Tree.LeafView</a></li>
            
                <li><a href="../classes/Tree.NodeRecordMixin.html">Tree.NodeRecordMixin</a></li>
            
                <li><a href="../classes/Tree.NodeView.html">Tree.NodeView</a></li>
            
                <li><a href="../classes/Tree.TreeColumnData.html">Tree.TreeColumnData</a></li>
            
                <li><a href="../classes/Tree.TreeColumnDataGroup.html">Tree.TreeColumnDataGroup</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/alerts.html">alerts</a></li>
            
                <li><a href="../modules/app-wrapper.html">app-wrapper</a></li>
            
                <li><a href="../modules/drag-drop.html">drag-drop</a></li>
            
                <li><a href="../modules/global-module.html">global-module</a></li>
            
                <li><a href="../modules/global-module-column-data.html">global-module-column-data</a></li>
            
                <li><a href="../modules/global-module-view.html">global-module-view</a></li>
            
                <li><a href="../modules/lazy-display.html">lazy-display</a></li>
            
                <li><a href="../modules/list-column-data.html">list-column-data</a></li>
            
                <li><a href="../modules/list-group.html">list-group</a></li>
            
                <li><a href="../modules/list-item.html">list-item</a></li>
            
                <li><a href="../modules/model-wrapper.html">model-wrapper</a></li>
            
                <li><a href="../modules/panel-column-data.html">panel-column-data</a></li>
            
                <li><a href="../modules/panel-views.html">panel-views</a></li>
            
                <li><a href="../modules/panels.html">panels</a></li>
            
                <li><a href="../modules/timer.html">timer</a></li>
            
                <li><a href="../modules/tree.html">tree</a></li>
            
                <li><a href="../modules/tree-column-data.html">tree-column-data</a></li>
            
                <li><a href="../modules/tree-nodes.html">tree-nodes</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: src/js/main/column-data.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
ColumnData = Ember.Namespace.create();

ColumnData.ColumnDataGroup = Ember.Object.extend({
  init : function (){
    this._super();
    this.set(&quot;columns&quot;, this.get(&quot;columns&quot;) || []);
    ColumnData.Registry.store(this.get(&quot;name&quot;), &quot;columnDataGroup&quot;, this);
  },

  name : &quot;&quot;,

  columns : Utils.hasMany(&quot;ColumnData.ColumnData&quot;),

  list : Utils.belongsTo(&quot;ListGroup.ListColumnDataGroup&quot;),
  tree : Utils.belongsTo(&quot;Tree.TreeColumnDataGroup&quot;),
  sort : Utils.belongsTo(&quot;DragDrop.SortableColumnDataGroup&quot;),
  panel : Utils.belongsTo(&quot;Panels.PanelColumnDataGroup&quot;),

  lazyDisplay : Utils.belongsTo(&quot;LazyDisplay.LazyDisplayColumnDataGroup&quot;),

  form : Utils.belongsTo(&quot;Form.FormColumnDataGroup&quot;),
});


ColumnData.Registry = Ember.Object.create({
  map : {},

  store : function(name, parent, columnData) {
    this.get(&quot;map&quot;)[parent+&quot;:&quot;+name] = columnData;
  },

  retrieve : function(name, parent) {
    return this.get(&quot;map&quot;)[parent+&quot;:&quot;+name];
  },
});

/***  ColumnData  ***/

ColumnData.ColumnData = Ember.Object.extend({
  init : function () {
    this._super();
    ColumnData.Registry.store(this.get(&quot;name&quot;), &quot;columnData&quot;, this);
  },

  name : &quot;&quot;,
  keyName : &quot;&quot;,
  //used when you need different entries for the same attr in the record
  key : function() {
    return this.get(&quot;keyName&quot;) || this.get(&quot;name&quot;);
  }.property(&quot;keyName&quot;, &quot;name&quot;),

  validation : Utils.belongsTo(&quot;ColumnData.ColumnDataValidation&quot;),

  list : Utils.belongsToWithMixin(null, &quot;ListGroup.ListColumnDataMap&quot;, &quot;moduleType&quot;, &quot;GlobalModules.GlobalModulesColumnDataMixinMap&quot;, &quot;viewType&quot;, &quot;GlobalModules.DisplayTextColumnDataMixin&quot;),
  tree : Utils.belongsToWithMixin(null, &quot;Tree.TreeColumnDataMap&quot;, &quot;moduleType&quot;, &quot;GlobalModules.GlobalModulesColumnDataMixinMap&quot;, &quot;viewType&quot;, &quot;GlobalModules.DisplayTextColumnDataMixin&quot;),
  //sort : Utils.belongsToWithMixin(null, &quot;DragDrop.SortableColumnDataMap&quot;, &quot;moduleType&quot;, &quot;GlobalModules.GlobalModulesColumnDataMixinMap&quot;, &quot;viewType&quot;, &quot;GlobalModules.DisplayTextColumnDataMixin&quot;),
  panel : Utils.belongsToWithMixin(null, &quot;Panels.PanelColumnDataMap&quot;, &quot;moduleType&quot;, &quot;GlobalModules.GlobalModulesColumnDataMixinMap&quot;, &quot;viewType&quot;, &quot;GlobalModules.DisplayTextColumnDataMixin&quot;),

  form : Utils.belongsTo(null, &quot;Form.FormColumnDataMap&quot;, &quot;type&quot;),

  label : null,

  childCol : Utils.belongsTo(&quot;ColumnData.ColumnData&quot;),
  childColName : function(key, value) {
    if(arguments.length &gt; 1) {
      if(value) {
        this.set(&quot;childCol&quot;, ColumnData.Registry.retrieve(value, &quot;columnData&quot;));
      }
      return value;
    }
  }.property(),
  childColGroup : Utils.belongsTo(&quot;ColumnData.ColumnDataGroup&quot;),
  childColGroupName : function(key, value) {
    if(arguments.length &gt; 1) {
      if(value) {
        this.set(&quot;childColGroup&quot;, ColumnData.Registry.retrieve(value, &quot;columnDataGroup&quot;));
      }
      return value;
    }
  }.property(),
});


/***  ColumnDataValidation  ***/

ColumnData.ColumnDataValidationsMap = {};
ColumnData.ColumnDataValidation = Ember.Object.extend({
  init : function() {
    this._super();
    this.canBeEmpty();
  },

  validations : Utils.hasMany(null, ColumnData.ColumnDataValidationsMap, &quot;type&quot;),
  validate : Ember.computed.notEmpty(&#x27;validations&#x27;),
  validateValue : function(value, record, validations) {
    var invalid = [false, &quot;&quot;];
    validations = validations || this.get(&quot;validations&quot;);
    for(var i = 0; i &lt; validations.length; i++) {
      invalid = validations[i].validateValue(value, record);
      if(invalid[0]) break;
    }
    return invalid;
  },

  canBeEmpty : function() {
    if(this.get(&quot;validations&quot;) &amp;&amp; !this.get(&quot;validations&quot;).mapBy(&quot;type&quot;).contains(0)) {
      this.set(&quot;mandatory&quot;, false);
      this.get(&quot;validations&quot;).forEach(function(item) {
        item.set(&#x27;canBeEmpty&#x27;, true);
      });
    }
    else {
      this.set(&quot;mandatory&quot;, true);
    }
  }.observes(&#x27;validations.@each&#x27;),

  mandatory : false,
});

/** ColumnDataValidations **/

ColumnData.EmptyValidation = Ember.Object.extend({
  invalidMessage : &quot;&quot;,
  negate : false,

  validateValue : function(value, record) {
    var invalid = Ember.isEmpty(value) || /^\s*$/.test(value),
        negate = this.get(&quot;negate&quot;);
    invalid = (negate &amp;&amp; !invalid) || (!negate &amp;&amp; invalid);
    return [invalid, this.get(&quot;invalidMessage&quot;)];
  },

  canBeEmpty : false,
});

ColumnData.RegexValidation = ColumnData.EmptyValidation.extend({
  regex : &quot;&quot;,
  regexFlags : &quot;&quot;,
  regexObject : function() {
    return new RegExp(this.get(&quot;regex&quot;), this.get(&quot;regexFlags&quot;));
  }.property(&#x27;regex&#x27;),

  validateValue : function(value, record) {
    var invalid = false, negate = this.get(&quot;negate&quot;),
        isEmpty, emptyBool;
    if(value &amp;&amp; value.trim) value = value.trim();
    isEmpty = Ember.isEmpty(value);
    emptyBool = (this.get(&quot;canBeEmpty&quot;) &amp;&amp; negate) || (!this.get(&quot;canBeEmpty&quot;) &amp;&amp; !negate);
    invalid = (isEmpty &amp;&amp; emptyBool) || this.get(&quot;regexObject&quot;).test(value);
    invalid = (negate &amp;&amp; !invalid) || (!negate &amp;&amp; invalid);
    return [invalid, this.get(&quot;invalidMessage&quot;)];
  },
});

ColumnData.CSVRegexValidation = ColumnData.RegexValidation.extend({
  delimeter : &quot;,&quot;,

  validateValue : function(value, record) {
    var invalid = false, negate = this.get(&quot;negate&quot;),
        isEmpty, emptyBool;
    if(value &amp;&amp; value.trim) value = value.trim();
    isEmpty = Ember.isEmpty(value);
    if(!isEmpty) {
      value.split(this.get(&quot;delimeter&quot;)).some(function(item) { 
        item = item.trim();
        invalid = this.get(&quot;regexObject&quot;).test(item); 
        return negate ? !invalid : invalid; 
      }, this); 
      invalid = (negate &amp;&amp; !invalid) || (!negate &amp;&amp; invalid);
    }
    return [invalid, this.get(&quot;invalidMessage&quot;)];
  },
});

ColumnData.CSVDuplicateValidation = ColumnData.CSVRegexValidation.extend({
  validateValue : function(value, record) {
    var invalid = false, negate = this.get(&quot;negate&quot;),
        isEmpty, emptyBool, valuesMap = {};
    if(value &amp;&amp; value.trim) value = value.trim();
    isEmpty = Ember.isEmpty(value);
    if(!isEmpty) {
      value.split(this.get(&quot;delimeter&quot;)).some(function(item) { 
        item = item.trim();
        if(valuesMap[item]) {
          invalid = true;
        }
        else {
          valuesMap[item] = 1;
        }
        return negate ? !invalid : invalid; 
      }, this); 
      invalid = (negate &amp;&amp; !invalid) || (!negate &amp;&amp; invalid);
    }
    return [invalid, this.get(&quot;invalidMessage&quot;)];
  },
});

ColumnData.DuplicateAcrossRecordsValidation = ColumnData.EmptyValidation.extend({
  duplicateCheckPath : &quot;&quot;,
  duplicateCheckKey : &quot;id&quot;,

  validateValue : function(value, record) {
    var invalid = false, negate = this.get(&quot;negate&quot;),
        arr = record.get(this.get(&quot;duplicateCheckPath&quot;)),
        values = arr &amp;&amp; arr.filterBy(this.get(&quot;duplicateCheckKey&quot;), value);
    invalid = (values &amp;&amp; values.get(&quot;length&quot;) &gt; 1) || (values.get(&quot;length&quot;) === 1 &amp;&amp; values[0] !== record);
    invalid = (negate &amp;&amp; !invalid) || (!negate &amp;&amp; invalid);
    return [invalid, this.get(&quot;invalidMessage&quot;)];
  },
});

ColumnData.NumberRangeValidation = ColumnData.EmptyValidation.extend({
  minValue : 0,
  maxValue : 999999,

  validateValue : function(value, record) {
    var invalid = false, negate = this.get(&quot;negate&quot;);
    if(value &amp;&amp; value.trim) value = value.trim();
    if(Ember.isEmpty(value)) {
      invalid = (this.get(&quot;canBeEmpty&quot;) &amp;&amp; negate) || (!this.get(&quot;canBeEmpty&quot;) &amp;&amp; !negate);
    }
    else {
      var num = Number(value);
      if(num &lt; this.get(&quot;minValue&quot;) || num &gt; this.get(&quot;maxValue&quot;)) invalid = true;
    }
    invalid = (negate &amp;&amp; !invalid) || (!negate &amp;&amp; invalid);
    return [invalid, this.get(&quot;invalidMessage&quot;)];
  },
});

ColumnData.ColumnDataValidationsMap[0] = ColumnData.EmptyValidation;
ColumnData.ColumnDataValidationsMap[1] = ColumnData.RegexValidation;
ColumnData.ColumnDataValidationsMap[2] = ColumnData.CSVRegexValidation;
ColumnData.ColumnDataValidationsMap[3] = ColumnData.CSVDuplicateValidation;
ColumnData.ColumnDataValidationsMap[4] = ColumnData.DuplicateAcrossRecordsValidation;
ColumnData.ColumnDataValidationsMap[5] = ColumnData.NumberRangeValidation;


/***  MISC   ***/

ColumnData.ColumnDataValueMixin = Ember.Mixin.create({
  columnData : null,
  record : null,

  validateValue : function(value) {
    var columnData = this.get(&quot;columnData&quot;), record = this.get(&quot;record&quot;),
        validation = columnData.get(&quot;validation&quot;);
    if(validation) {
      if(!this.get(&quot;disabled&quot;)) {
        var validVal = validation.validateValue(value, record);
        if(validVal[0]) record._validation[columnData.name] = 1;
        else delete record._validation[columnData.name];
        this.set(&quot;invalid&quot;, validVal[0]);
        this.set(&quot;invalidReason&quot;, !Ember.isEmpty(validVal[1]) &amp;&amp; validVal[1]);
      }
      else {
        delete record._validation[columnData.name];
      }
    }
    record.set(&quot;validationFailed&quot;, Utils.hashHasKeys(record._validation));
  },

  value : function(key, val) {
    var columnData = this.get(&quot;columnData&quot;), record = this.get(&quot;record&quot;),
        parentForm = this.get(&quot;parentForm&quot;);
    if(!record || !columnData) return val;
    record._validation = record._validation || {};
    if(arguments.length &gt; 1) {
      if(!(record instanceof DS.Model) || (record.currentState &amp;&amp; !record.currentState.stateName.match(&quot;deleted&quot;))) {
        var oldVal = record.get(columnData.get(&quot;key&quot;));
        this.validateValue(val);
        //TODO : find a better way to fix value becoming null when selection changes
        if(val || !columnData.get(&quot;cantBeNull&quot;)) {
          record.set(columnData.get(&quot;key&quot;), val);
          this.valueDidChange(val);
          if(record.valueDidChange) {
            record.valueDidChange(columnData, val);
          }
        }
      }
      return val;
    }
    else {
      val = record.get(columnData.get(&quot;key&quot;));
      this.validateValue(val);
      return val;
    }
  }.property(&#x27;columnData&#x27;, &#x27;view.columnData&#x27;),

  valueDidChange : function(val) {
  },

  prevRecord : null,
  recordDidChange : function() {
    var record = this.get(&quot;record&quot;), prevRecord = this.get(&quot;prevRecord&quot;),
        columnData = this.get(&quot;columnData&quot;);
    if(prevRecord) {
      Ember.removeObserver(prevRecord, columnData.get(&quot;name&quot;), this, &quot;notifyValChange&quot;);
    }
    if(record) {
      this.recordChangeHook();
      Ember.addObserver(record, columnData.get(&quot;name&quot;), this, &quot;notifyValChange&quot;);
      this.set(&quot;prevRecord&quot;, record);
      this.notifyPropertyChange(&quot;val&quot;);
    }
    else {
      this.recordRemovedHook();
    }
  }.observes(&quot;view.record&quot;, &quot;record&quot;),
  recordChangeHook : function() {
    this.notifyPropertyChange(&#x27;isDisabled&#x27;);
  },
  recordRemovedHook : function(){
  },
});

ColumnData.ColumnDataGroupPluginMixin = Ember.Mixin.create(Utils.ObjectWithArrayMixin, {
  init : function() {
    this._super();
    var arrayProps = this.get(&quot;arrayProps&quot;);
    if(!arrayProps.contains(&quot;modules&quot;)) {
      arrayProps.pushObject(&quot;modules&quot;);
    }
  },

  type : &quot;base&quot;,
  typeLookup : function() {
    return this.get(&quot;lookupMap&quot;)[this.get(&quot;groupType&quot;)][this.get(&quot;type&quot;)];
  }.property(&quot;type&quot;),

  arrayProps : [&#x27;modules&#x27;],
  modules : null,

  modulesWillBeDeleted : function(modules, idxs) {
    for(var i = 0; i &lt; modules.length; i++) {
      this.removeObserver(modules[i]+&quot;Type&quot;, this, &quot;moduleTypeDidChange&quot;);
    }
  },
  modulesWasAdded : function(modules, idxs) {
    for(var i = 0; i &lt; modules.length; i++) {
      this.addObserver(modules[i]+&quot;Type&quot;, this, &quot;moduleTypeDidChange&quot;);
      this.moduleTypeDidChange(this, modules[i]+&quot;Type&quot;);
    }
    this.columnsChanged();
  },

  moduleTypeDidChange : function(obj, key) {
    var module = key.match(/^(\w*)Type$/)[1];
    this.set(module+&quot;Lookup&quot;, this.get(&quot;lookupMap&quot;)[module][this.get(key) || &quot;base&quot;]);
  },

  columnsChanged : function() {
    var columns = this.get(&quot;parentObj.columns&quot;), modules = this.get(&quot;modules&quot;);
    if(columns) {
      for(var i = 0; i &lt; modules.length; i++) {
        this.set(modules[i]+&quot;ColumnData&quot;, columns.findBy(this.get(&quot;groupType&quot;)+&quot;.type&quot;, modules[i]));
      }
    }
  }.observes(&quot;parentObj.columns.@each.panel&quot;),
});


/***   Initilizer   ***/

ColumnData.initializer = function(app) {
  if(app.ColumnData) {
    for(var i = 0; i &lt; app.ColumnData.length; i++) {
      ColumnData.ColumnDataGroup.create(app.ColumnData[i]);
    }
  }
};

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
